{"ast":null,"code":"/**\n * @fileoverview receives a query as string and \n * @returns a json containing results \n */\nconst axios = require('axios').default;\n\nconst transform = inputObject => {\n  const outputObject = {\n    author: {\n      name: \"Diego M.\",\n      lastname: \"Maldini Freyre\"\n    },\n    categories: [],\n    items: []\n  };\n  inputObject.available_filters.map(currentObject => {\n    if (currentObject.id === \"category\") {\n      currentObject.values.map(currCategory => outputObject.categories.push(currCategory.name));\n    }\n  });\n  inputObject.results.map(currentItem => outputObject.items.push({\n    id: currentItem.id,\n    title: currentItem.title,\n    price: {\n      currency: currentItem.currency_id,\n      amount: Math.floor(currentItem.price),\n      decimals: Math.floor((currentItem.price - Math.floor(currentItem.price)) * 100)\n    },\n    picture: currentItem.thumbnail,\n    condition: currentItem.condition,\n    free_shipping: currentItem.shipping.free_shipping\n  }));\n  return outputObject;\n};\n\nconst getSearchResults = (req, res) => {\n  const url = `https://api.mercadolibre.com/sites/MLA/search?q=${req.query.q}`;\n  axios.get(url).then(response => transform(response.data)).then(finalObject => res.json(finalObject)).catch(error => console.log(error));\n};\n\nmodule.exports = getSearchResults;","map":{"version":3,"sources":["/home/ubuntu/Escritorio/github/app-011-meli-assignment/functions/getSearchResults.js"],"names":["axios","require","default","transform","inputObject","outputObject","author","name","lastname","categories","items","available_filters","map","currentObject","id","values","currCategory","push","results","currentItem","title","price","currency","currency_id","amount","Math","floor","decimals","picture","thumbnail","condition","free_shipping","shipping","getSearchResults","req","res","url","query","q","get","then","response","data","finalObject","json","catch","error","console","log","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAAP,CAAiBC,OAA/B;;AAEA,MAAMC,SAAS,GAAGC,WAAW,IAAI;AAC7B,QAAMC,YAAY,GAAG;AACjBC,IAAAA,MAAM,EAAE;AACJC,MAAAA,IAAI,EAAE,UADF;AAEJC,MAAAA,QAAQ,EAAE;AAFN,KADS;AAKjBC,IAAAA,UAAU,EAAE,EALK;AAMjBC,IAAAA,KAAK,EAAE;AANU,GAArB;AAQAN,EAAAA,WAAW,CAACO,iBAAZ,CACKC,GADL,CACSC,aAAa,IAAI;AAClB,QAAIA,aAAa,CAACC,EAAd,KAAqB,UAAzB,EAAqC;AACjCD,MAAAA,aAAa,CAACE,MAAd,CAAqBH,GAArB,CAAyBI,YAAY,IACjCX,YAAY,CAACI,UAAb,CAAwBQ,IAAxB,CAA6BD,YAAY,CAACT,IAA1C,CADJ;AAGH;AAAC,GANV;AAOAH,EAAAA,WAAW,CAACc,OAAZ,CAAoBN,GAApB,CAAwBO,WAAW,IAAId,YAAY,CAACK,KAAb,CAAmBO,IAAnB,CACnC;AACIH,IAAAA,EAAE,EAAEK,WAAW,CAACL,EADpB;AAEIM,IAAAA,KAAK,EAAED,WAAW,CAACC,KAFvB;AAGIC,IAAAA,KAAK,EAAE;AACHC,MAAAA,QAAQ,EAAEH,WAAW,CAACI,WADnB;AAEHC,MAAAA,MAAM,EAAEC,IAAI,CAACC,KAAL,CAAWP,WAAW,CAACE,KAAvB,CAFL;AAGHM,MAAAA,QAAQ,EAAEF,IAAI,CAACC,KAAL,CAAW,CAACP,WAAW,CAACE,KAAZ,GAAoBI,IAAI,CAACC,KAAL,CAAWP,WAAW,CAACE,KAAvB,CAArB,IAAsD,GAAjE;AAHP,KAHX;AAQIO,IAAAA,OAAO,EAAET,WAAW,CAACU,SARzB;AASIC,IAAAA,SAAS,EAAEX,WAAW,CAACW,SAT3B;AAUIC,IAAAA,aAAa,EAAEZ,WAAW,CAACa,QAAZ,CAAqBD;AAVxC,GADmC,CAAvC;AAcA,SAAO1B,YAAP;AACH,CA/BD;;AAiCA,MAAM4B,gBAAgB,GAAG,CAACC,GAAD,EAAMC,GAAN,KAAc;AACnC,QAAMC,GAAG,GAAI,mDAAkDF,GAAG,CAACG,KAAJ,CAAUC,CAAE,EAA3E;AACAtC,EAAAA,KAAK,CAACuC,GAAN,CAAUH,GAAV,EACKI,IADL,CACUC,QAAQ,IAAItC,SAAS,CAACsC,QAAQ,CAACC,IAAV,CAD/B,EAEKF,IAFL,CAEUG,WAAW,IAAIR,GAAG,CAACS,IAAJ,CAASD,WAAT,CAFzB,EAGKE,KAHL,CAGWC,KAAK,IAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAHpB;AAIH,CAND;;AAQAG,MAAM,CAACC,OAAP,GAAiBjB,gBAAjB","sourcesContent":["/**\n * @fileoverview receives a query as string and \n * @returns a json containing results \n */\nconst axios = require('axios').default;\n\nconst transform = inputObject => {\n    const outputObject = {\n        author: {\n            name: \"Diego M.\",\n            lastname: \"Maldini Freyre\"\n        },\n        categories: [],\n        items: [],\n    }\n    inputObject.available_filters\n        .map(currentObject => { \n            if (currentObject.id === \"category\") {\n                currentObject.values.map(currCategory => \n                    outputObject.categories.push(currCategory.name)\n                );\n            }})\n    inputObject.results.map(currentItem => outputObject.items.push(\n        {\n            id: currentItem.id,\n            title: currentItem.title,\n            price: {\n                currency: currentItem.currency_id,\n                amount: Math.floor(currentItem.price),\n                decimals: Math.floor((currentItem.price - Math.floor(currentItem.price)) * 100)\n            },\n            picture: currentItem.thumbnail,\n            condition: currentItem.condition,\n            free_shipping: currentItem.shipping.free_shipping,\n        }\n    ));\n    return outputObject;\n}\n\nconst getSearchResults = (req, res) => {\n    const url = `https://api.mercadolibre.com/sites/MLA/search?q=${req.query.q}`;\n    axios.get(url)\n        .then(response => transform(response.data))\n        .then(finalObject => res.json(finalObject))\n        .catch(error => console.log(error));\n}\n\nmodule.exports = getSearchResults;"]},"metadata":{},"sourceType":"script"}